{
  "dependencies": [
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DCOVERAG.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "FLDRIVR1.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CUSTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "AGNTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    }
  ],
  "copybookUsage": {
    "DBDRIVR1.cbl": [
      "SQLCA.cpy",
      "DPOLICY.cpy",
      "DCOVERAG.cpy",
      "DTRAKING.cpy"
    ],
    "DBDRIVR2.cbl": [
      "SQLCA.cpy",
      "DTRAKING.cpy"
    ],
    "FLDRIVR1.cbl": [
      "CAGENT.cpy"
    ],
    "FLDRIVR2.cbl": [],
    "MAINPGM.cbl": [
      "CPOLICY.cpy",
      "CAGENT.cpy",
      "CUSTNTFY.cpy",
      "AGNTNTFY.cpy"
    ]
  },
  "reverseDependencies": {
    "SQLCA.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "DPOLICY.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DCOVERAG.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DTRAKING.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "CAGENT.cpy": [
      "FLDRIVR1.cbl",
      "MAINPGM.cbl"
    ],
    "CPOLICY.cpy": [
      "MAINPGM.cbl"
    ],
    "CUSTNTFY.cpy": [
      "MAINPGM.cbl"
    ],
    "AGNTNTFY.cpy": [
      "MAINPGM.cbl"
    ]
  },
  "mermaidDiagram": "graph TB\n  %% Subgraph: COBOL Programs\n  subgraph COBOL Programs\n    style COBOL Programs fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\n    DBDRIVR1[\u0022DBDRIVR1.cbl\u0022]\n    DBDRIVR2[\u0022DBDRIVR2.cbl\u0022]\n    FLDRIVR1[\u0022FLDRIVR1.cbl\u0022]\n    FLDRIVR2[\u0022FLDRIVR2.cbl\u0022]\n    MAINPGM[\u0022MAINPGM.cbl\u0022]\n    %% Program node styles\n    style DBDRIVR1 fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n    style DBDRIVR2 fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n    style FLDRIVR1 fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n    style FLDRIVR2 fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n    style MAINPGM fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n  end\n\n  %% Subgraph: Copybooks\n  subgraph Copybooks\n    style Copybooks fill:#fff3e0,stroke:#f57c00,stroke-width:2px\n    SQLCA[\u0022SQLCA.cpy\u0022]\n    DPOLICY[\u0022DPOLICY.cpy\u0022]\n    DCOVERAG[\u0022DCOVERAG.cpy\u0022]\n    DTRAKING[\u0022DTRAKING.cpy\u0022]\n    CAGENT[\u0022CAGENT.cpy\u0022]\n    CPOLICY[\u0022CPOLICY.cpy\u0022]\n    CUSTNTFY[\u0022CUSTNTFY.cpy\u0022]\n    AGNTNTFY[\u0022AGNTNTFY.cpy\u0022]\n    %% Copybook node styles\n    style SQLCA fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style DPOLICY fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style DCOVERAG fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style DTRAKING fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style CAGENT fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style CPOLICY fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style CUSTNTFY fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n    style AGNTNTFY fill:#ffe0b2,stroke:#f57c00,stroke-width:2px\n  end\n\n  %% Dependencies\n  DBDRIVR1 --\u003E|COPY| SQLCA\n  DBDRIVR1 --\u003E|COPY| DPOLICY\n  DBDRIVR1 --\u003E|COPY| DCOVERAG\n  DBDRIVR1 --\u003E|COPY| DTRAKING\n\n  DBDRIVR2 --\u003E|COPY| SQLCA\n  DBDRIVR2 --\u003E|COPY| DTRAKING\n\n  FLDRIVR1 --\u003E|COPY| CAGENT\n\n  MAINPGM --\u003E|COPY| CPOLICY\n  MAINPGM --\u003E|COPY| CAGENT\n  MAINPGM --\u003E|COPY| CUSTNTFY\n  MAINPGM --\u003E|COPY| AGNTNTFY",
  "analysisInsights": "**COBOL Dependency Structure Analysis**\n\n### 1. Data Flow Dependencies Between Copybooks\n\n**DBDRIVR1.cbl**\n- Uses: \u0060SQLCA.cpy\u0060, \u0060DPOLICY.cpy\u0060, \u0060DCOVERAG.cpy\u0060, \u0060DTRAKING.cpy\u0060\n  - **SQLCA.cpy**: Standard SQL communication area, likely for DB error/status.\n  - **DPOLICY.cpy**, **DCOVERAG.cpy**, **DTRAKING.cpy**: Data structures for policy, coverage, and tracking.\n\n**DBDRIVR2.cbl**\n- Uses: \u0060SQLCA.cpy\u0060, \u0060DTRAKING.cpy\u0060\n  - Shares \u0060SQLCA.cpy\u0060 and \u0060DTRAKING.cpy\u0060 with DBDRIVR1, suggesting similar DB and tracking logic.\n\n**FLDRIVR1.cbl**\n- Uses: \u0060CAGENT.cpy\u0060\n  - Agent data structure, likely for field operations.\n\n**FLDRIVR2.cbl**\n- Uses: *(none)*\n  - No copybooks; possibly standalone logic or legacy code.\n\n**MAINPGM.cbl**\n- Uses: \u0060CPOLICY.cpy\u0060, \u0060CAGENT.cpy\u0060, \u0060CUSTNTFY.cpy\u0060, \u0060AGNTNTFY.cpy\u0060\n  - Central program, aggregates policy, agent, customer notification, and agent notification data.\n\n**Data Flow Observations:**\n- **DBDRIVR1/2**: Share DB and tracking structures, likely interact with policy/coverage/tracking tables.\n- **FLDRIVR1**: Isolated agent data flow.\n- **MAINPGM**: Centralizes multiple business entities, likely orchestrates overall logic.\n\n### 2. Potential Circular Dependencies\n\n- **Copybooks** are included by programs, not vice versa. No evidence of copybooks including other copybooks.\n- **No direct circular dependencies** detected from the usage patterns provided.\n- If copybooks themselves include other copybooks (not shown), circularity could arise. **Recommend verifying copybook contents.**\n\n### 3. Modularity Recommendations\n\n- **Separation of Concerns**: Each driver program (DBDRIVR*, FLDRIVR*) uses distinct copybooks, indicating modularity by business function (DB vs. Field).\n- **MAINPGM**: Aggregates multiple copybooks\u2014could be a candidate for refactoring if logic is monolithic.\n  - **Recommendation**: Break MAINPGM into smaller modules or subprograms, each handling a specific entity (policy, agent, notification).\n- **Copybook Reuse**: \u0060CAGENT.cpy\u0060 is used by both FLDRIVR1 and MAINPGM, suggesting shared agent logic. Ensure copybook fields are not overloaded for different contexts.\n- **Unused Copybooks**: FLDRIVR2 does not use any copybooks. If possible, standardize data definitions via copybooks for consistency.\n\n### 4. Legacy Patterns Affecting Dependencies\n\n- **SQLCA.cpy**: Indicates embedded SQL, a legacy pattern. Modernization might involve abstracting DB logic.\n- **Monolithic MAINPGM**: Large size (28K chars) suggests legacy procedural style. Modularization would improve maintainability.\n- **Copybook Overloading**: If copybooks contain unrelated fields, this can cause tight coupling and maintenance issues.\n- **Lack of Copybook in FLDRIVR2**: May indicate hardcoded data structures or legacy code not aligned with current modular practices.\n\n---\n\n## Summary \u0026 Recommendations\n\n**Dependency Architecture Insights:**\n- Programs are modular by function, but MAINPGM is a central orchestrator with multiple dependencies.\n- No circular dependencies detected, but copybook contents should be checked for nested includes.\n- Copybooks are reused across programs, which is good for consistency but can lead to coupling if not well-structured.\n\n**Recommendations:**\n1. **Refactor MAINPGM** into smaller subprograms or modules for each business entity.\n2. **Standardize copybook usage** across all programs, including FLDRIVR2.\n3. **Review copybook contents** for unnecessary field inclusion or nested copybook usage.\n4. **Modernize SQL handling** by abstracting DB logic from business logic.\n5. **Document copybook dependencies** to prevent future circularity and improve onboarding.\n\n**Legacy Patterns to Address:**\n- Embedded SQL via SQLCA.cpy.\n- Large, monolithic programs.\n- Potential copybook overloading.\n\n**Overall:** The project shows reasonable modularity, but MAINPGM and legacy patterns present maintainability risks. Refactoring and standardization will improve dependency management and future extensibility.",
  "metrics": {
    "totalPrograms": 5,
    "totalCopybooks": 7,
    "totalDependencies": 11,
    "averageDependenciesPerProgram": 2.2,
    "mostUsedCopybook": "SQLCA.cpy",
    "mostUsedCopybookCount": 2,
    "circularDependencies": []
  },
  "createdAt": "2025-11-11T01:28:25.2872532Z"
}