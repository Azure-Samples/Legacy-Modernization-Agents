{
  "dependencies": [
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DCOVERAG.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "FLDRIVR1.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CUSTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "AGNTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    }
  ],
  "copybookUsage": {
    "DBDRIVR1.cbl": [
      "SQLCA.cpy",
      "DPOLICY.cpy",
      "DCOVERAG.cpy",
      "DTRAKING.cpy"
    ],
    "DBDRIVR2.cbl": [
      "SQLCA.cpy",
      "DTRAKING.cpy"
    ],
    "FLDRIVR1.cbl": [
      "CAGENT.cpy"
    ],
    "FLDRIVR2.cbl": [],
    "MAINPGM.cbl": [
      "CPOLICY.cpy",
      "CAGENT.cpy",
      "CUSTNTFY.cpy",
      "AGNTNTFY.cpy"
    ]
  },
  "reverseDependencies": {
    "SQLCA.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "DPOLICY.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DCOVERAG.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DTRAKING.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "CAGENT.cpy": [
      "FLDRIVR1.cbl",
      "MAINPGM.cbl"
    ],
    "CPOLICY.cpy": [
      "MAINPGM.cbl"
    ],
    "CUSTNTFY.cpy": [
      "MAINPGM.cbl"
    ],
    "AGNTNTFY.cpy": [
      "MAINPGM.cbl"
    ]
  },
  "mermaidDiagram": "graph TB\n  %% Styles\n  classDef program fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1,rx:8,ry:8;\n  classDef copybook fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100,rx:8,ry:8;\n  classDef header fill:#c8e6c9,stroke:#388e3c,stroke-width:2px,color:#1b5e20,rx:8,ry:8;\n\n  %% Subgraph: COBOL Programs\n  subgraph COBOL Programs\n    direction TB\n    DBDRIVR1[\u0022DBDRIVR1.cbl\u0022]\n    DBDRIVR2[\u0022DBDRIVR2.cbl\u0022]\n    FLDRIVR1[\u0022FLDRIVR1.cbl\u0022]\n    FLDRIVR2[\u0022FLDRIVR2.cbl\u0022]\n    MAINPGM[\u0022MAINPGM.cbl\u0022]\n  end\n\n  %% Subgraph: Copybooks\n  subgraph Copybooks\n    direction TB\n    SQLCA[\u0022SQLCA.cpy\u0022]\n    DPOLICY[\u0022DPOLICY.cpy\u0022]\n    DCOVERAG[\u0022DCOVERAG.cpy\u0022]\n    DTRAKING[\u0022DTRAKING.cpy\u0022]\n    CAGENT[\u0022CAGENT.cpy\u0022]\n    CPOLICY[\u0022CPOLICY.cpy\u0022]\n    CUSTNTFY[\u0022CUSTNTFY.cpy\u0022]\n    AGNTNTFY[\u0022AGNTNTFY.cpy\u0022]\n  end\n\n  %% Dependencies\n  DBDRIVR1 --\u003E|COPY| SQLCA\n  DBDRIVR1 --\u003E|COPY| DPOLICY\n  DBDRIVR1 --\u003E|COPY| DCOVERAG\n  DBDRIVR1 --\u003E|COPY| DTRAKING\n\n  DBDRIVR2 --\u003E|COPY| SQLCA\n  DBDRIVR2 --\u003E|COPY| DTRAKING\n\n  FLDRIVR1 --\u003E|COPY| CAGENT\n\n  MAINPGM --\u003E|COPY| CPOLICY\n  MAINPGM --\u003E|COPY| CAGENT\n  MAINPGM --\u003E|COPY| CUSTNTFY\n  MAINPGM --\u003E|COPY| AGNTNTFY\n\n  %% Styling\n  class DBDRIVR1,DBDRIVR2,FLDRIVR1,FLDRIVR2,MAINPGM program;\n  class SQLCA,DPOLICY,DCOVERAG,DTRAKING,CAGENT,CPOLICY,CUSTNTFY,AGNTNTFY copybook;",
  "analysisInsights": "**COBOL Dependency Analysis**\n\n### 1. Data Flow Dependencies Between Copybooks\n\n**Copybook Usage Matrix:**\n\n| Program      | Copybooks Used                                 |\n|--------------|------------------------------------------------|\n| DBDRIVR1.cbl | SQLCA.cpy, DPOLICY.cpy, DCOVERAG.cpy, DTRAKING.cpy |\n| DBDRIVR2.cbl | SQLCA.cpy, DTRAKING.cpy                        |\n| FLDRIVR1.cbl | CAGENT.cpy                                     |\n| FLDRIVR2.cbl | (none)                                         |\n| MAINPGM.cbl  | CPOLICY.cpy, CAGENT.cpy, CUSTNTFY.cpy, AGNTNTFY.cpy |\n\n**Data Flow Insights:**\n- **SQLCA.cpy** is used by both DBDRIVR1 and DBDRIVR2, indicating shared SQL error/status handling.\n- **DTRAKING.cpy** is also shared between DBDRIVR1 and DBDRIVR2, suggesting common tracking or audit data.\n- **CAGENT.cpy** is used by FLDRIVR1 and MAINPGM, indicating agent-related data is accessed in both file and main processing.\n- **DPOLICY.cpy, DCOVERAG.cpy** are only used in DBDRIVR1, likely for policy and coverage data.\n- **CPOLICY.cpy** (note the different prefix from DPOLICY.cpy) is used in MAINPGM, possibly a different or extended policy structure.\n- **CUSTNTFY.cpy, AGNTNTFY.cpy** are notification-related and only used in MAINPGM.\n\n**Implications:**\n- There is **no direct overlap** between database drivers (DBDRIVR*) and file drivers (FLDRIVR*) in terms of copybook usage, except for MAINPGM which acts as an aggregator.\n- **MAINPGM.cbl** is the most copybook-dependent, indicating it is the central orchestrator.\n\n---\n\n### 2. Potential Circular Dependencies\n\n- **No evidence of circular dependencies** in copybook usage: No copybook is included in a program that also includes another program that uses the first copybook.\n- **Copybooks are not used recursively** (i.e., no copybook includes another copybook that leads back to itself).\n- **Programs do not include each other**; only copybooks are included.\n\n---\n\n### 3. Modularity Recommendations\n\n**Observations:**\n- **MAINPGM.cbl** is very large (28,099 chars) and uses four copybooks, suggesting monolithic design.\n- **DBDRIVR1/2 and FLDRIVR1/2** are more modular, each using a subset of copybooks.\n\n**Recommendations:**\n- **Refactor MAINPGM.cbl**: Consider splitting MAINPGM into smaller subprograms or modules, each handling a distinct business function (e.g., policy processing, agent notification).\n- **Standardize Copybook Usage**: If DPOLICY.cpy and CPOLICY.cpy serve similar purposes, consider consolidating or clearly differentiating their roles.\n- **Promote Reuse**: Shared copybooks (e.g., CAGENT.cpy, DTRAKING.cpy) should be well-documented and designed for reuse.\n- **Encapsulate Database/File Logic**: Keep DBDRIVR* and FLDRIVR* logic separate, and interface with MAINPGM via well-defined data structures.\n\n---\n\n### 4. Legacy Patterns Affecting Dependencies\n\n**Patterns Identified:**\n- **Heavy use of copybooks** for data structure sharing, typical in legacy COBOL.\n- **Monolithic main program** (MAINPGM.cbl) is a legacy anti-pattern, leading to tight coupling and difficult maintenance.\n- **Copybook naming conventions** (e.g., DPOLICY vs CPOLICY) may reflect historical evolution and lack of standardization.\n- **No modularization via CALLed subprograms** is evident; everything is included via copybooks.\n\n**Impact:**\n- **Tight coupling** between programs and copybooks can make changes risky and error-prone.\n- **Potential for data structure drift** if similar copybooks (e.g., DPOLICY.cpy vs CPOLICY.cpy) are not synchronized.\n- **Scalability and maintainability** are limited by the monolithic structure.\n\n---\n\n## Summary \u0026 Recommendations\n\n- **No circular dependencies** detected.\n- **MAINPGM.cbl is a bottleneck** for maintainability; refactor into smaller modules.\n- **Standardize and document copybooks** to avoid confusion and drift.\n- **Encourage modular design**: Use CALLed subprograms for business logic, not just copybooks.\n- **Legacy patterns** (monolithic programs, copybook sprawl) should be addressed for future-proofing.\n\n**Actionable Steps:**\n1. Audit and consolidate copybooks where possible.\n2. Refactor MAINPGM into smaller, focused subprograms.\n3. Document shared data structures and their intended usage.\n4. Move towards a more modular, service-oriented COBOL architecture.",
  "metrics": {
    "totalPrograms": 5,
    "totalCopybooks": 7,
    "totalDependencies": 11,
    "averageDependenciesPerProgram": 2.2,
    "mostUsedCopybook": "SQLCA.cpy",
    "mostUsedCopybookCount": 2,
    "circularDependencies": []
  },
  "createdAt": "2025-11-11T05:28:21.0662287Z"
}