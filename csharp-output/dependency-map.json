{
  "dependencies": [
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DCOVERAG.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR1.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "SQLCA.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "DBDRIVR2.cbl",
      "targetFile": "DTRAKING.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "FLDRIVR1.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CPOLICY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CAGENT.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "CUSTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    },
    {
      "sourceFile": "MAINPGM.cbl",
      "targetFile": "AGNTNTFY.cpy",
      "dependencyType": "COPY",
      "lineNumber": 0,
      "context": "Copybook inclusion"
    }
  ],
  "copybookUsage": {
    "DBDRIVR1.cbl": [
      "SQLCA.cpy",
      "DPOLICY.cpy",
      "DCOVERAG.cpy",
      "DTRAKING.cpy"
    ],
    "DBDRIVR2.cbl": [
      "SQLCA.cpy",
      "DTRAKING.cpy"
    ],
    "FLDRIVR1.cbl": [
      "CAGENT.cpy"
    ],
    "FLDRIVR2.cbl": [],
    "MAINPGM.cbl": [
      "CPOLICY.cpy",
      "CAGENT.cpy",
      "CUSTNTFY.cpy",
      "AGNTNTFY.cpy"
    ]
  },
  "reverseDependencies": {
    "SQLCA.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "DPOLICY.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DCOVERAG.cpy": [
      "DBDRIVR1.cbl"
    ],
    "DTRAKING.cpy": [
      "DBDRIVR1.cbl",
      "DBDRIVR2.cbl"
    ],
    "CAGENT.cpy": [
      "FLDRIVR1.cbl",
      "MAINPGM.cbl"
    ],
    "CPOLICY.cpy": [
      "MAINPGM.cbl"
    ],
    "CUSTNTFY.cpy": [
      "MAINPGM.cbl"
    ],
    "AGNTNTFY.cpy": [
      "MAINPGM.cbl"
    ]
  },
  "mermaidDiagram": "graph TB\n%% Styles\nclassDef program fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#0d47a1;\nclassDef copybook fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#e65100;\nclassDef subgraphTitle fill:#eeeeee,stroke:none,color:#333;\n\n%% Programs Subgraph\nsubgraph Programs [COBOL Programs]\n    direction TB\n    DBDRIVR1[\u0022DBDRIVR1.cbl\u0022]\n    DBDRIVR2[\u0022DBDRIVR2.cbl\u0022]\n    FLDRIVR1[\u0022FLDRIVR1.cbl\u0022]\n    FLDRIVR2[\u0022FLDRIVR2.cbl\u0022]\n    MAINPGM[\u0022MAINPGM.cbl\u0022]\nend\nclass Programs subgraphTitle\nclass DBDRIVR1,DBDRIVR2,FLDRIVR1,FLDRIVR2,MAINPGM program\n\n%% Copybooks Subgraph\nsubgraph Copybooks [COBOL Copybooks]\n    direction TB\n    SQLCA[\u0022SQLCA.cpy\u0022]\n    DPOLICY[\u0022DPOLICY.cpy\u0022]\n    DCOVERAG[\u0022DCOVERAG.cpy\u0022]\n    DTRAKING[\u0022DTRAKING.cpy\u0022]\n    CAGENT[\u0022CAGENT.cpy\u0022]\n    CPOLICY[\u0022CPOLICY.cpy\u0022]\n    CUSTNTFY[\u0022CUSTNTFY.cpy\u0022]\n    AGNTNTFY[\u0022AGNTNTFY.cpy\u0022]\nend\nclass Copybooks subgraphTitle\nclass SQLCA,DPOLICY,DCOVERAG,DTRAKING,CAGENT,CPOLICY,CUSTNTFY,AGNTNTFY copybook\n\n%% Dependencies\nDBDRIVR1 --\u003E|COPY| SQLCA\nDBDRIVR1 --\u003E|COPY| DPOLICY\nDBDRIVR1 --\u003E|COPY| DCOVERAG\nDBDRIVR1 --\u003E|COPY| DTRAKING\n\nDBDRIVR2 --\u003E|COPY| SQLCA\nDBDRIVR2 --\u003E|COPY| DTRAKING\n\nFLDRIVR1 --\u003E|COPY| CAGENT\n\nMAINPGM --\u003E|COPY| CPOLICY\nMAINPGM --\u003E|COPY| CAGENT\nMAINPGM --\u003E|COPY| CUSTNTFY\nMAINPGM --\u003E|COPY| AGNTNTFY",
  "analysisInsights": "**COBOL Dependency Structure Analysis**\n\n### 1. Data Flow Dependencies Between Copybooks\n\n#### Observed Copybook Usage:\n\n- **DBDRIVR1.cbl:**  \n  - \u0060SQLCA.cpy\u0060 (SQL communication area, DB status)  \n  - \u0060DPOLICY.cpy\u0060 (Policy data)  \n  - \u0060DCOVERAG.cpy\u0060 (Coverage data)  \n  - \u0060DTRAKING.cpy\u0060 (Tracking data)  \n\n- **DBDRIVR2.cbl:**  \n  - \u0060SQLCA.cpy\u0060  \n  - \u0060DTRAKING.cpy\u0060  \n\n- **FLDRIVR1.cbl:**  \n  - \u0060CAGENT.cpy\u0060 (Agent data)  \n\n- **FLDRIVR2.cbl:**  \n  - *(No copybooks used)*  \n\n- **MAINPGM.cbl:**  \n  - \u0060CPOLICY.cpy\u0060  \n  - \u0060CAGENT.cpy\u0060  \n  - \u0060CUSTNTFY.cpy\u0060  \n  - \u0060AGNTNTFY.cpy\u0060  \n\n#### Data Flow Insights:\n\n- **Database Drivers (\u0060DBDRIVR1\u0060, \u0060DBDRIVR2\u0060)** share \u0060SQLCA.cpy\u0060 and \u0060DTRAKING.cpy\u0060, suggesting both interact with DB and tracking data.\n- **Policy and Coverage data** are only in \u0060DBDRIVR1\u0060, not \u0060DBDRIVR2\u0060.\n- **File Drivers (\u0060FLDRIVR1\u0060, \u0060FLDRIVR2\u0060)** are more isolated; only \u0060FLDRIVR1\u0060 uses \u0060CAGENT.cpy\u0060.\n- **MAINPGM** aggregates multiple copybooks, indicating it is a central orchestrator, possibly coordinating agent, policy, and notification data.\n\n### 2. Potential Circular Dependencies\n\n- **No direct circular dependencies** are evident from the copybook usage. Each program includes copybooks, but copybooks themselves are not shown to include other copybooks.\n- **Risk:** If copybooks themselves include other copybooks (not shown), circularity could arise. For example, if \u0060CAGENT.cpy\u0060 included \u0060CPOLICY.cpy\u0060 and vice versa.\n- **Recommendation:** Audit copybooks for nested \u0060COPY\u0060 statements to ensure no circular inclusion.\n\n### 3. Modularity Recommendations\n\n- **Separation of Concerns:**  \n  - Database drivers and file drivers are well-separated by their copybook usage.\n  - MAINPGM is a central hub; consider refactoring if it grows too large (currently 28,099 chars).\n- **Copybook Granularity:**  \n  - Some copybooks (e.g., \u0060SQLCA.cpy\u0060) are shared across programs, which is good for consistency.\n  - Consider splitting large copybooks if they contain unrelated data structures.\n- **Encapsulation:**  \n  - Avoid sharing copybooks that contain both data and business logic; keep copybooks strictly for data definitions.\n- **Reduce MAINPGM Coupling:**  \n  - If MAINPGM is tightly coupled to many copybooks, modularize its logic into subprograms or callable modules.\n\n### 4. Legacy Patterns Affecting Dependencies\n\n- **SQLCA.cpy Usage:**  \n  - Classic pattern for DB status handling; can lead to tight coupling with DBMS.\n- **Monolithic MAINPGM:**  \n  - Large central program is a legacy pattern, often hard to maintain and test.\n- **Flat Copybook Inclusion:**  \n  - All data definitions are included at compile time, which can lead to bloated working-storage and accidental data sharing.\n- **Lack of File Driver Copybooks:**  \n  - FLDRIVR2.cbl does not use any copybooks, possibly indicating hardcoded data structures or legacy file handling.\n\n---\n\n## **Summary \u0026 Recommendations**\n\n**Dependency Structure:**\n- Programs are modular in terms of copybook usage, with clear separation between DB and file drivers.\n- MAINPGM acts as a central coordinator, aggregating multiple data definitions.\n\n**Recommendations:**\n1. **Audit copybooks for nested inclusions** to prevent circular dependencies.\n2. **Modularize MAINPGM** if possible; break into smaller subprograms.\n3. **Refactor copybooks** to ensure they contain only data definitions, not logic.\n4. **Introduce copybooks for FLDRIVR2** if appropriate, to standardize data definitions.\n5. **Consider modernizing legacy patterns** (e.g., replace monolithic programs with modular calls, use parameter passing instead of global copybooks).\n\n**Legacy Risks:**\n- Large, monolithic programs and shared global copybooks can hinder maintainability and scalability.\n- SQLCA.cpy is necessary for DB work but should be isolated to DB-specific modules.\n\n**Overall:**  \nThe project shows reasonable modularity but would benefit from further decomposition of large programs and careful management of copybook inclusions to avoid future dependency issues.",
  "metrics": {
    "totalPrograms": 5,
    "totalCopybooks": 7,
    "totalDependencies": 11,
    "averageDependenciesPerProgram": 2.2,
    "mostUsedCopybook": "SQLCA.cpy",
    "mostUsedCopybookCount": 2,
    "circularDependencies": []
  },
  "createdAt": "2025-11-11T07:21:38.89881Z"
}